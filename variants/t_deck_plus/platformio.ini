[env:t_deck_plus]
extends = esp32
board = T-Deck
platform = espressif32 @ 6.6.0 ;https://github.com/Bodmer/TFT_eSPI/issues/3332
upload_command = pio pkg exec -p "tool-esptoolpy" -- esptool.py -b 921600 write_flash 0x0000 ${platformio.build_dir}/${this.__env__}/bootloader.bin 0xE000 otadata.bin 0x8000 ${platformio.build_dir}/${this.__env__}/partitions.bin 0x10000 ${platformio.build_dir}/esp32-S3-safeboot/safeboot.bin 0xC0000 ${platformio.build_dir}/${this.__env__}/firmware.bin
;board_build.partitions = default_16MB.csv

build_src_filter = 
	${esp32.src_filter}
	+<t-deck/*>
	+<lib/lvgl/*>

lib_deps =
	${libs.lib_deps}
	${esp32libs.lib_deps}
	lewisxhe/SensorLib @ ^0.2.6
	bxparks/AceButton @ ^1.10.1
	esphome/ESP32-audioI2S @ ^2.0.7

build_flags = 
	${esp32.build_flags}
    -DBOARD_HAS_PSRAM=1
    -DCORE_DEBUG_LEVEL=1
    -DARDUINO_USB_CDC_ON_BOOT=1  ; Enable UARDUINO_USB_CDC_ON_BOOT will start printing and wait for terminal access during startup
    ; -UARDUINO_USB_CDC_ON_BOOT  ; Enable UARDUINO_USB_CDC_ON_BOOT will turn off printing and will not block when using the battery
	-D LV_CONF_INCLUDE_SIMPLE
	-D BOARD_T_DECK="tdeck-plus"
    -D DISABLE_ALL_LIBRARY_WARNINGS=1	
	-I variants/${this.__env__}